function inicializarSistemaComunal() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  const tablas = {
    "Configuracion": ["ID_Consejo", "Nombre_Consejo", "RIF", "Mision", "Logo", "Telefono_Contacto", "Email", "Direccion"],
    "Vocerias": ["ID_Voceria", "Nombre_Voceria", "Descripcion", "Icono"],
    "Voceros": ["ID_Vocero", "Nombre_Apellido", "ID_Voceria", "Fecha_Nacimiento", "Tipo_Vocero", "Telefono", "Foto_Vocero", "Estatus"],
    "Censo_Familias": ["ID_Familia", "Nombre_Jefe", "Cedula_Jefe", "Fecha_Nacimiento_Jefe", "Tipo_Vivienda", "Condicion_Vivienda", "Servicios_Fallas", "Requerimiento_Prioritario", "Ubicacion_GPS"],
    "Integrantes_Nucleo": ["ID_Persona", "ID_Familia", "Nombre", "Parentesco", "Fecha_Nacimiento", "Ocupacion", "Nivel_Escolaridad", "Padece_Enfermedad", "Requiere_Medicamentos", "Carnet_Patria", "Codapidis"],
    "Proyectos_Blog": ["ID_Proyecto", "Titulo_Proyecto", "ID_Voceria", "Estado", "Descripcion", "Fecha_Inicio", "Imagen_Avance", "Publicar_Web"],
    "Documentacion_Plantillas": ["ID_Documento", "Nombre_Documento", "Categoria", "Enlace_Plantilla_GDoc", "Acceso_Publico"],
    "Solicitudes_Tramites": ["ID_Solicitud", "ID_Persona", "Tipo_Documento", "Fecha_Hora", "Estatus", "Codigo_QR_Hash", "Aporte_Pago_Movil"],
    "CLAP_Jornadas": ["ID_Jornada", "Nombre_Jornada", "Costo_Bolsa", "Fecha_Llegada", "Estatus_Jornada"],
    "CLAP_Pagos": ["ID_Pago", "ID_Jornada", "ID_Familia", "Referencia_Pago", "Monto_Pagado", "Estatus_Entrega"]
  };

  for (let nombre in tablas) {
    let sheet = ss.getSheetByName(nombre) || ss.insertSheet(nombre);
    sheet.clear(); 
    
    // 1. Definir Colores
    let colorFondo = "#1565C0"; // Azul
    if (nombre === "Configuracion") colorFondo = "#C62828"; // Rojo
    else if (nombre.includes("CLAP")) colorFondo = "#2E7D32"; // Verde
    else if (nombre.includes("Documentacion") || nombre.includes("Solicitudes")) colorFondo = "#757575"; // Gris
    else if (nombre === "Proyectos_Blog") colorFondo = "#6A1B9A"; // Morado

    // 2. Insertar Encabezados
    const numCols = tablas[nombre].length;
    sheet.getRange(1, 1, 1, numCols)
         .setValues([tablas[nombre]])
         .setBackground(colorFondo)
         .setFontColor("white")
         .setFontWeight("bold");
    
    sheet.setTabColor(colorFondo);

    // 3. LIMPIEZA: Eliminar columnas y filas sobrantes
    // Dejar solo las columnas necesarias
    let maxCols = sheet.getMaxColumns();
    if (maxCols > numCols) {
      sheet.deleteColumns(numCols + 1, maxCols - numCols); //
    }

    // Dejar solo 5 filas (Encabezado + 4 vacías)
    let maxRows = sheet.getMaxRows();
    const filasDeseadas = 5;
    if (maxRows > filasDeseadas) {
      sheet.deleteRows(filasDeseadas + 1, maxRows - filasDeseadas); //
    } else if (maxRows < filasDeseadas) {
      sheet.insertRowsAfter(maxRows, filasDeseadas - maxRows);
    }
  }
  
  Browser.msgBox("¡Estructura Minimalista Creada! Tablas ajustadas a su tamaño y 5 filas máximo.");
}
